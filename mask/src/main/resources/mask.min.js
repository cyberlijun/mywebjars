$.fn.extend({mask:function(message){var $target=this,fixed=false,targetStatic=true;if(Object.prototype.toString.call(message)!=='[object String]'||!message){message='请稍候。。。';}
if($target.length===0){$target=$('body');}else{if($target.length>1){$target=$target.first();}
if($target[0]===window||$target[0]===document){$target=$('body');}}
if($target[0]===document.body){fixed=true;}
var old=$target.data('rhui.mask');if(old){old.$content.html(message);center($target,old.$content,fixed);return;}
if($target.css('position')==='static'){targetStatic=true;$target.css('position','relative');}
var $content,$overlay;if(fixed){$overlay=$('<div class="rhui-mask" style="position:fixed;"></div>');$content=$('<div class="rhui-mask-content" style="position:fixed;">'+message+'</div>');}else{$overlay=$('<div class="rhui-mask"></div>');$content=$('<div class="rhui-mask-content">'+message+'</div>');}
$overlay.appendTo($target);$content.appendTo($target);$overlay.show();$content.show();center($target,$content,fixed);$target.data('rhui.mask',{fixed:fixed,$overlay:$overlay,$content:$content,targetStatic:targetStatic});function center($target,$content,fixed){var $window,height=$content.outerHeight(true),width=$content.outerWidth(true);if(fixed){$window=$(window);$content.css({left:($window.width()-width)/2,top:($window.height()-height)/2});}else{$content.css({left:($target.width()-width)/2,top:($target.height()-height)/2});}}},unmask:function(){var $target;if(this.length===0){$target=$('body');}else{$target=this.first();if($target[0]===window||$target[0]===document){$target=$('body');}}
var data=$target.data('rhui.mask');if(!data){return;}
if(data.targetStatic){$target.css('position','static');}
data.$overlay.remove();data.$content.remove();$target.removeData('rhui.mask');}});